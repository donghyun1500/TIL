# ê·¸ ì—¬ì •ì´ ë°”ë¡œ ë³´ìƒì´ë‹¤.ðŸŽ

The journey is the reward.

# - ìŠ¤í‹°ë¸Œ ìž¡ìŠ¤ðŸ -


ì˜¤ëŠ˜ ë“œë””ì–´ í•­í•´99 ë§ˆì§€ë§‰ í”„ë¡œì íŠ¸ì¸ ì‹¤ì „ í”„ë¡œì íŠ¸ë¥¼ ë§žì´í•˜ëŠ” ì²«ë‚ ì´ë‹¤.. ë§ë„ ë§Žê³  íƒˆë„ ë§Žì€ íŒ€ì› ì„ íƒì„ ë’¤ë¡œí•˜ê³  íŒ€ì´ ìž¬ì„ íƒ ë˜ëŠ”ë™ì•ˆ ì •ë§ í‘¹ ì‰¬ì—ˆë‹¤..ã…‹ã…‹ã…‹ã…‹ðŸ¤£

ì‰¬ë©´ ì•ˆë˜ëŠ” ì‹¤ë ¥ì¸ê±´ ì•„ëŠ”ë°..ðŸ˜­ì •ë§ ë„ˆë¬´ í”¼ê³¤í–ˆë‹¤..ã… ðŸ¥± 

ì‚¬ì‹¤ ì´ë²ˆ ì‹¤ì „ í”„ë¡œì íŠ¸ëŠ” íŒ€ìž¥ë‹˜ë“¤ ì•„ì´ë””ì–´ëŠ” ë‹¤ ë¹„ìŠ·ë¹„ìŠ·í•˜ê²Œ ì „ë¶€ë‹¤ ê´œì°®ì•˜ë˜ê±° ê°™ì•˜ê¸°ì— ì•„ì´ë””ì–´ë¡œ ê³ ë¥´ê¸´ ì‰½ì§€ ì•Šì•˜ê³ , 

ê±°ê¸°ì— ë‚œ ì¹œë¶„ìžˆëŠ” ì‚¬ëžŒë„ ì—†ë‹¤ë³´ë‹ˆ ì–´ë–»ê²Œ íŒ€ì„ ì´ˆì´ìŠ¤í• ê¹Œ ê³ ë¯¼í•˜ë‹¤ê°€ ê·¸ëƒ¥ ì •ë§ ë‹¨ìˆœí•˜ê²Œ íŒ€ìž¥ë‹˜ë§Œ ë³´ê³  ì§€ì›í•˜ì˜€ë‹¤.

ê·¸ëž˜ì„œ ê²°êµ­ ì²«ë²ˆì§¸ ëžœë¤ìœ¼ë¡œ ì •í•´ì¡Œë˜ íŒ€ìœ¼ë¡œ ë‹¤ì‹œ ìž¬ì„ íƒ ë˜ì—ˆê³ , ë„ˆë¬´ë‚˜ ì›í–ˆë˜ íŒ€ìž¥ë‹˜ê³¼ íŒ€ì›ë¶„ë“¤ì„ ë§Œë‚¬ê¸°ì— ì´ë²ˆ í”Œì  ë„ˆë¬´ ê¸°ëŒ€ì¤‘ì´ë‹¤!ðŸ¥°

ë‚˜ì˜ ì‹¤ì „ í”„ë¡œì íŠ¸ë¥¼ ìž„í•˜ëŠ” ê°ì˜¤ëŠ” í•­í•´99ì—ì„œì˜ ë§ˆì§€ë§‰ì´ìž ì œì¼ ì¤‘ìš”í•œ ë¯¸ì…˜ì´ë‹ˆê¹ ì •ë§ ìµœì„ ì„ ë‹¤í•´ì„œ íŒ€ì— íì•ˆë¼ì¹˜ê³  ìµœëŒ€í•œ ë„ì›€ì´ ë  ìˆ˜ ìžˆê²Œ ìµœì„ ì„ ë‹¤í•´ì„œ ë…¸ë ¥ í•´ë³¼ë ¤ê³  í•œë‹¤..

ìž ë„ ëœ ìžê³  ì•ˆì§€ì¹˜ê²Œ í‹ˆí‹ˆížˆ ìš´ë™ë„ í•˜ë©´ì„œ ì²´ë ¥ ìœ ì§€ ìž˜í•´ì„œ ëê¹Œì§€ í•œëˆˆ ì•ˆíŒ”ê³  ì—´ì‹¬ížˆ í•´ë³´ê³  ì‹¶ë‹¤.. ë‚˜ ì œì™¸í•˜ê³  ë””ìžì´ë„ˆë¶„ë“¤ê¹Œì§€ í•´ì„œ ì´ 7ëª…! 

6ì£¼ë™ì•ˆ ìž˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤!ðŸ‘


ê·¸ë¦¬ê³  ì˜¤ëŠ˜ ì €ë…ì— íšŒì˜ë¥¼ í•œ í›„ ì†Œì¼“ioë¥¼ ë‹¤ì‹œ í•œ ë²ˆ ì²´í¬í•˜ì˜€ë‹¤.. í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€ í™•ì¸í• ê²¸ ì‹¬í™”ë°˜ë–„ ë´¤ë˜ê±° ìž¬ë³µìŠµ ê²¸ íŒ€ìž¥ë‹˜ì´ ì¶”ì²œí•´ì¤€ ê°•ì˜ë¥¼ ë“¤ì–´ë³´ì•˜ê³ ..

ì–´ëŠì •ë„ ì†Œì¼“ ê°œë…ì€ ë‹¤ì‹œ ìž¡ížŒê±° ê°™ë‹¤..

    const mongoose = require("mongoose")
    const Document = require("./Document")

    mongoose.connect('mongodb://localhost/google-docs-clone', {            //ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
        useNewUrlParser: true,
        useUnifiedTopology: true,
        useFindAndModify: false,
        useCreateIndex: true
    });


    const io = require('socket.io')(3001, {                         //í´ë¼ì´ì–¸íŠ¸ì™€ ì†Œì¼“ ì—°ê²°
        cors: {
            origin: "http://localhost:3000",
            methods: ["GET", "POST"],
        },
    })

    const defaultValue = ""

    io.on("connection", socket => {                                 
        socket.on('get-document', async documentId => {                    //socket.emit('Event', data); : ì „ì†¡
            const document = await findOrCreateDocument(documentId)        // socket.on('Event',function(data)) : ìˆ˜ì‹ 
            socket.join(documentId)
            socket.emit('load-document', document.data)

            socket.on("send-changes", delta => {
                socket.broadcast.to(documentId).emit("receive-changes", delta)    //íŠ¹ì • documentIdì—ì„œ ëª¨ë‘ì—ê²Œ ë°ì´í„°ë¥¼ ë¿Œë ¤ì¤€ë‹¤.
            })
        
            socket.on("save-document", async data => {
                await Document.findByIdAndUpdate(documentId, { data })
            })
        })    
    })

    async function findOrCreateDocument(id) {
        if (id == null) return

        const document = await Document.findById(id)
        if (document) return document
        return await Document.create({ _id:id, data: defaultValue })
    }
    
    
     

